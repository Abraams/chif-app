!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b,c=navigator.userAgent,d=/iphone/i.test(c),e=/chrome/i.test(c),f=/android/i.test(c);a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},a.fn.extend({caret:function(a,b){var c;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof a?(b="number"==typeof b?b:a,this.each(function(){this.setSelectionRange?this.setSelectionRange(a,b):this.createTextRange&&(c=this.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select())})):(this[0].setSelectionRange?(a=this[0].selectionStart,b=this[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length),{begin:a,end:b})},unmask:function(){return this.trigger("unmask")},mask:function(c,g){var h,j,l,m,n,o,q,r;if(!c&&0<this.length){h=a(this[0]);var s=h.data(a.mask.dataName);return s?s():void 0}return g=a.extend({autoclear:a.mask.autoclear,placeholder:a.mask.placeholder,completed:null},g),j=a.mask.definitions,l=[],m=q=c.length,n=null,a.each(c.split(""),function(a,b){"?"==b?(q--,m=a):j[b]?(l.push(new RegExp(j[b])),null===n&&(n=l.length-1),m>a&&(o=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function h(){if(g.completed){for(var a=n;o>=a;a++)if(l[a]&&E[a]===k(a))return;g.completed.call(D)}}function k(a){return g.placeholder.charAt(a<g.placeholder.length?a:0)}function s(a){for(;++a<q&&!l[a];);return a}function t(a){for(;0<=--a&&!l[a];);return a}function u(a,b){var c,d;if(!(0>a)){for(c=a,d=s(b);q>c;c++)if(l[c]){if(!(q>d&&l[c].test(E[d])))break;E[c]=E[d],E[d]=k(d),d=s(d)}B(),D.caret(Math.max(n,a))}}function v(a){var b,d,e,f;for(b=a,d=k(a);q>b;b++)if(l[b]){if(e=s(b),f=E[b],E[b]=d,!(q>e&&l[e].test(f)))break;d=f}}function w(){var a=D.val(),b=D.caret();if(r&&r.length&&r.length>a.length){for(C(!0);0<b.begin&&!l[b.begin-1];)b.begin--;if(0===b.begin)for(;b.begin<n&&!l[b.begin];)b.begin++;D.caret(b.begin,b.begin)}else{for(C(!0);b.begin<q&&!l[b.begin];)b.begin++;D.caret(b.begin,b.begin)}h()}function x(){C(),D.val()!=G&&D.change()}function y(a){if(!D.prop("readonly")){var b,c,e,f=a.which||a.keyCode;r=D.val(),8===f||46===f||d&&127===f?(b=D.caret(),c=b.begin,e=b.end,0==e-c&&(c=46===f?e=s(c-1):t(c),e=46===f?s(e):e),A(c,e),u(c,e-1),a.preventDefault()):13===f?x.call(this,a):27===f&&(D.val(G),D.caret(0,C()),a.preventDefault())}}function z(b){if(!D.prop("readonly")){var d,e,g,i=b.which||b.keyCode,j=D.caret();if(!(b.ctrlKey||b.altKey||b.metaKey||32>i)&&i&&13!==i){if(0!=j.end-j.begin&&(A(j.begin,j.end),u(j.begin,j.end-1)),d=s(j.begin-1),q>d&&(e=String.fromCharCode(i),l[d].test(e))){if(v(d),E[d]=e,B(),g=s(d),f){var k=function(){a.proxy(a.fn.caret,D,g)()};setTimeout(k,0)}else D.caret(g);j.begin<=o&&h()}b.preventDefault()}}}function A(a,b){var c;for(c=a;b>c&&q>c;c++)l[c]&&(E[c]=k(c))}function B(){D.val(E.join(""))}function C(a){var b,d,e,f=D.val(),h=-1;for(b=0,e=0;q>b;b++)if(l[b]){for(E[b]=k(b);e++<f.length;)if(d=f.charAt(e-1),l[b].test(d)){E[b]=d,h=b;break}if(e>f.length){A(b+1,q);break}}else E[b]===f.charAt(e)&&e++,m>b&&(h=b);return a?B():m>h+1?g.autoclear||E.join("")===F?(D.val()&&D.val(""),A(0,q)):B():(B(),D.val(D.val().substring(0,h+1))),m?b:n}var D=a(this),E=a.map(c.split(""),function(a,b){return"?"==a?void 0:j[a]?k(b):a}),F=E.join(""),G=D.val();D.data(a.mask.dataName,function(){return a.map(E,function(a,b){return l[b]&&a!=k(b)?a:null}).join("")}),D.one("unmask",function(){D.off(".mask").removeData(a.mask.dataName)}).on("focus.mask",function(){if(!D.prop("readonly")){clearTimeout(b);var a;G=D.val(),a=C(),b=setTimeout(function(){D.get(0)===document.activeElement&&(B(),a==c.replace("?","").length?D.caret(0,a):D.caret(a))},10)}}).on("blur.mask",x).on("keydown.mask",y).on("keypress.mask",z).on("input.mask paste.mask",function(){D.prop("readonly")||setTimeout(function(){var a=C(!0);D.caret(a),h()},0)}),e&&f&&D.off("input.mask").on("input.mask",w),C()})}})});